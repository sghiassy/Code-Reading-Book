/* Generated by Together */
#include "ApplicationKit.h"
#include "COMObject.h"


using namespace VCFCOM;

COMObject::COMObject()	
{
	this->m_ref = 0;
}

COMObject::~COMObject()
{

}


STDMETHODIMP COMObject::QueryInterface(REFIID riid, PPVOID ppv)
{
    *ppv=NULL;
	if ( (true != supportsInterface( riid, ppv )) && (IID_IUnknown==riid) ){
        *ppv=this;
	}
    if (NULL!=*ppv)
	{
        ((LPUNKNOWN)*ppv)->AddRef();

#ifdef _DEBUG		
		
#endif

        return NOERROR;
	}
	
    return ResultFromScode(E_NOINTERFACE);
}


STDMETHODIMP_(ULONG) COMObject::AddRef(void)
{	
    return ++ this->m_ref;
}

STDMETHODIMP_(ULONG) COMObject::Release(void)
{
	--this->m_ref;

#ifdef _DEBUG
	
#endif

    if (0 != this->m_ref){
        return this->m_ref;
	}
	
    delete this;
    return 0;
}


