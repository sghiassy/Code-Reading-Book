<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.0//EN" "../../dtd/document-v10.dtd">

<document>
	<header>
		<title>Directory Generator</title>
		<version>0.9</version>
		<type>Technical document</type>
		<authors>
			<person name="Carsten Ziegeler" email="cziegeler@apache.org"/>
		 </authors>
		 <abstract>This document describes the directory generator of Cocoon.</abstract>
	</header>
	<body>
		<s1 title="Directory Generator">
			<p>Generates an XML directory listing.</p>
      <p>
        The root node of the generated document will normally be a
        <code>directory</code> node, and a directory node can contain zero
        or more <code>file</code> or <code>directory</code> nodes. A file node has no
        children. Each node will contain the following attributes:
      </p>
      <ul>
        <li>name : the name of the file or directory</li>
        <li>lastModified : the time the file was last modified, measured as the number of
        milliseconds since the epoch (as in java.io.File.lastModified)</li>
        <li>date (optional) : the time the file was last modified in human-readable form</li>
      </ul>
      <p>All generated elements have the namespace
        <code>http://apache.org/cocoon/directory/2.0</code>.
        The root <code>directory</code>
        node has the attribute <code>requested</code> with the value <code>true</code>.
      </p>
      <ul>
        <li>Name : directory</li>
        <li>Class: org.apache.cocoon.generation.DirectoryGenerator</li>
        <li>Cacheable: no.</li>
      </ul>
<source><![CDATA[
  <map:generate type="directory" src="the_directory"/>
]]></source>
		</s1>
    <s1 title="Configuration">
      <p>The following parameter can be specified in the pipeline for 
         the generate command:
      </p>
      <ul>
        <li>depth (optional) : Sets how deep Directory Generator should delve into the
         directory structure. If set to 1 (the default), only the starting
         directory's immediate contents will be returned.</li>
        <li>dateFormat (optional) :  Sets the format for the date attribute of each node, as
         described in java.text.SimpleDateFormat. If unset, the default
         format for the current locale will be used.</li>
        <li>root (optional) : The root pattern</li>
        <li>include (optional) : The include pattern</li>
        <li>exclude (optional) : The exclude pattern</li>
      </ul>
    </s1>
    <s1 title="DTD">
      <p>XML generated by directory generator uses namespace
        <code>http://apache.org/cocoon/status/2.0</code>. The DTD
        of XML generated by directory generator:
      </p>
<source><![CDATA[
  <!ELEMENT directory (directory|file)*>
  <!ATTLIST directroy
    name         CDATA #REQUIRED
    lastModified CDATA #REQUIRED
    date         CDATA #IMPLIED
    requested    CDATA #IMPLIED>
  
  <!ELEMENt file #EMPTY>
  <!ATTLIST file
    name         CDATA #REQUIRED
    lastModified CDATA #REQUIRED
    date         CDATA #IMPLIED>
]]></source>
    </s1>
    <s1 title="Example">
      <p>
        The current directory generator may generate following xml:
      </p>
<source><![CDATA[
<directory xmlns="http://apache.org/cocoon/directory/2.0" 
  name="stylesheets" lastModified="999425490000" 
  date="02.09.01 12:11" 
  requested="true">
  <directory name="sites" 
    lastModified="999425490000" date="02.09.01 12:11"/>
  <file name="dynamic-page2html.xsl" 
    lastModified="999425490000" date="02.09.01 12:11"/>
  <file name="simple-xml2html.xsl" 
    lastModified="999425490000" date="02.09.01 12:11"/>
</directory>
]]></source>
    </s1>
</body>
</document>
